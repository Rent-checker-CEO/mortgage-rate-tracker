<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UK Mortgage Rate Tracker – Spot Drops & Save</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; line-height: 1.6; color: #333; background: #f8f9fa; }
    header { background: linear-gradient(135deg, #007bff, #0056b3); color: white; padding: 60px 20px; text-align: center; border-radius: 0 0 16px 16px; margin-bottom: 30px; }
    .logo { width: 80px; height: 80px; margin-bottom: 15px; }
    h1 { margin: 0; font-size: 2.8em; }
    h2 { color: #222; border-bottom: 2px solid #007bff; padding-bottom: 10px; margin-top: 40px; }
    table { width: 100%; border-collapse: collapse; margin: 30px 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1); background: white; border-radius: 8px; overflow: hidden; }
    th, td { padding: 14px; text-align: left; border-bottom: 1px solid #eee; }
    th { background: #007bff; color: white; cursor: pointer; }
    tr:nth-child(even) { background: #f8f9fa; }
    .section { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin: 40px 0; }
    input, select, button { padding: 12px; margin: 10px 8px 10px 0; font-size: 16px; border: 1px solid #ccc; border-radius: 6px; }
    button { background: #28a745; color: white; border: none; cursor: pointer; }
    .gumroad-button { background: #ff5a5f; color: white; padding: 14px 28px; font-size: 18px; border-radius: 8px; text-decoration: none; display: inline-block; margin: 10px 0; font-weight: bold; }
    .gumroad-button:hover { background: #e94e58; }
    footer { text-align: center; padding: 30px 0; color: #666; border-top: 1px solid #ddd; margin-top: 50px; }
  </style>
</head>
<body>
  <header>
    <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <path d="M50 15 L15 50 L20 85 L80 85 L85 50 Z" fill="#ffffff" stroke="#0056b3" stroke-width="4"/>
      <rect x="35" y="50" width="30" height="35" fill="#ffffff" stroke="#0056b3" stroke-width="4"/>
      <circle cx="50" cy="35" r="8" fill="#0056b3"/>
    </svg>
    <h1>UK Mortgage Rate Tracker</h1>
    <p>Daily best fixed-rate deals — spot drops and save on remortgage. Free alerts + premium upgrades below!</p>
  </header>

  <div class="section">
    <h2>Top Fixed-Rate Deals</h2>
    <p>Last updated: <span id="updated">Loading...</span> | <a href="https://github.com/Rent-checker-CEO/mortgage-rate-tracker">Source on GitHub</a></p>
    <table id="deals-table">
      <thead>
        <tr>
          <th>Term</th><th>Lender</th><th>Rate (%)</th><th>LTV (%)</th><th>Fee (£)</th><th>Notes</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="section">
    <h2>Remortgage Calculator – Estimate Monthly Payments</h2>
    <p>Enter your details to see potential monthly repayments on a repayment mortgage (capital + interest).</p>
    <form id="calcForm">
      <label>Loan Amount (£):</label><br>
      <input type="number" id="loanAmount" placeholder="e.g. 200000" required min="1000"><br>
      <label>Interest Rate (%):</label><br>
      <input type="number" id="interestRate" placeholder="e.g. 3.75" step="0.01" required min="0"><br>
      <label>Term (Years):</label><br>
      <input type="number" id="termYears" placeholder="e.g. 25" required min="1"><br>
      <button type="button" onclick="calculateMortgage()">Calculate</button>
    </form>
    <p id="calcResult" style="margin-top:20px; font-weight:bold; color:#28a745;"></p>
  </div>

  <div class="section">
    <h2>Get Real Email Alerts When Rates Drop</h2>
    <p>Sign up below — we'll notify you if rates fall below your threshold (via email, powered by Google Forms).</p>
    <button onclick="window.open('https://docs.google.com/forms/d/e/1FAIpQLSclbKRu_NKCBfeyItgEcmAMTsxjf-CR6_EixS-PApPM3vDqhQ/viewform', '_blank')">Sign Up for Free Rate Drop Alerts</button>
    <p style="margin-top:15px;">(Opens form in new tab – enter email, threshold e.g. 4.0, term. Responses to your Google Sheet.)</p>
  </div>

  <div class="section">
    <h2>Premium Upgrades</h2>
    <p>Unlock priority alerts, templates, checklists & more:</p>
    <a class="gumroad-button" href="https://tkuser6.gumroad.com/l/qbcxso">Buy £2.99 – Premium Alerts + Spreadsheet Template</a>
    <br>
    <a class="gumroad-button" href="https://tkuser6.gumroad.com/l/cpquh">Buy £9.99 – Full Remortgage Checklist PDF</a>
  </div>

  <!-- Gumroad overlay script for popup checkout -->
  <script src="https://gumroad.com/js/gumroad.js"></script>

  <script>
    // Load deals from deals.json (your existing code)
    fetch('deals.json')
      .then(res => res.json())
      .then(data => {
        document.getElementById('updated').textContent = data.updated;
        const tbody = document.querySelector('#deals-table tbody');
        tbody.innerHTML = '';
        data.deals.forEach(deal => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${deal.term}</td>
            <td>${deal.lender}</td>
            <td>${deal.rate}</td>
            <td>${deal.ltv}</td>
            <td>${deal.fee}</td>
            <td>${deal.notes}</td>
          `;
          tbody.appendChild(row);
        });
      })
      .catch(err => console.error('Error loading deals:', err));

    // Table sorting (your existing code)
    document.querySelectorAll('#deals-table th').forEach((header, index) => {
      header.addEventListener('click', () => {
        const table = document.getElementById('deals-table');
        const rows = Array.from(table.querySelectorAll('tbody tr'));
        const isNumeric = [2,3,4].includes(index);
        rows.sort((a, b) => {
          let valA = a.cells[index].textContent.trim();
          let valB = b.cells[index].textContent.trim();
          if (isNumeric) return parseFloat(valA) - parseFloat(valB);
          return valA.localeCompare(valB);
        });
        rows.forEach(row => table.querySelector('tbody').appendChild(row));
      });
    });

    // Remortgage calculator (your existing code)
    function calculateMortgage() {
      const P = parseFloat(document.getElementById('loanAmount').value);
      const annualRate = parseFloat(document.getElementById('interestRate').value) / 100;
      const years = parseInt(document.getElementById('termYears').value);
      if (isNaN(P) || isNaN(annualRate) || isNaN(years) || P <= 0 || annualRate < 0 || years <= 0) {
        document.getElementById('calcResult').innerHTML = 'Please enter valid numbers.';
        return;
      }
      const r = annualRate / 12;
      const n = years * 12;
      const M = P * (r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
      const total = M * n;
      document.getElementById('calcResult').innerHTML = 
        `Estimated monthly payment: £${M.toFixed(2)}<br>Total repayable over ${years} years: £${total.toFixed(2)}`;
    }
  </script>

  <footer>
    <p>© 2026 Mortgage Rate Tracker | Built with GitHub Pages</p>
  </footer>
</body>
</html>
